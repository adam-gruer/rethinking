---
title: "chapter 4 practice"
author: "Adam Gruer"
date: "02/06/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rethinking)
library(dplyr)
library(tidyr)
library(ggplot2)
```


# Easy

## 4E1

y ~ Normal(mu, sigma) is the likelihood. 
The likelihood shows the distribution
of the variable being predicted

## 4E2 

There are two parameters in the posteriod distribution, mu and sigma

## 4E3

mu = a + b * x is the linear model

## 4E4



3 parameters a, b and sigma . mu is no longer a parameter as it is now a fnciton
of the other parameters

# Medium

## 4M1

y ~ Normal(mu, sigma)
mu ~ Normal(0, 10)
sigma ~ Exponential(1)

Simulate observed y from the prior
```{r}
sample_mu <- rnorm(1e4, 0, 10)
sample_sigma <- rexp(1e4, 1)
plot(sample_mu)
dens(sample_mu)
plot(sample_sigma)
dens(sample_sigma)
prior_y <- rnorm(1e4, sample_mu, sample_sigma)
plot(prior_y)
dens(prior_y, adj = 0.9)

```
## 4M2

```{r}
flist <- alist(
    y ~ dnorm(mu, sigma),
    mu ~ dnorm(0, 10),
    sigma ~ exp(1)
  )

```

## 4M3

translate quap model formula to mathematical model definition

```{r}
flist <- alist(
  y ~ dnorm(mu, sigma),
  mu <- a + b*x,
  a ~ dnorm(0, 10),
  b ~ dunif(0, 1),
  sigma ~ dexp(1)
)


```

y_i ~ Normal(mu_i, sigma)
mu_i = a + b * x_i
a ~ Normal(0, 10)
b ~ Uniform(0,1)
sigma ~ Exponential(1)

## 4M4

h_i ~ Normal(mu_i, sigma)
mu_i = a + b * (x - xbar)
a ~ Normal(130, 10)
b ~ LogNormal(0, 1) 
sigma ~ Exponential(1)

Assuming primary students . b 
```{r}
n <- 1000
tibble(group = seq_len(n),
       alpha = rnorm(n, 130, 10),
       beta = rlnorm(n, 0, 1 )) %>%
  expand(nesting(group, alpha, beta), year = c(1, 3)) %>%
  mutate(height = alpha + beta * (year - 2)) %>%
  ggplot(aes(x = year, y = height, group = group)) +
  geom_line(alpha = 1/10) +
  geom_hline(yintercept = c(0, 272), linetype = 2:1, color = "red") +
  annotate(geom = "text", x = 1, y = 0, hjust = 0, vjust = 1,
           label = "Embryo") +
  annotate(geom = "text", x = 1, y = 272, hjust = 0, vjust = 0,
           label = "World's tallest person (272cm)") +
  coord_cartesian(ylim = c(-25, 300)) +
  labs(x = "Year", y = "Height")

```

